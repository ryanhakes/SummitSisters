generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Event {
  id            String         @id @default(cuid())
  title         String
  slug          String         @unique
  description   String
  dateStart     DateTime
  dateEnd       DateTime?
  timezone      String
  locationName  String
  address       String?
  googleMapsLink String?
  capacity      Int?
  cost          Float?
  difficulty    String
  distance      String?
  elevationGain String?
  packingList   String?
  image         String?
  isPrivate     Boolean        @default(false)
  accessCode    String?
  published     Boolean        @default(true)
  registrations Registration[]
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
}

model Registration {
  id               String   @id @default(cuid())
  eventId          String
  name             String
  email            String
  phone            String?
  emergencyName    String
  emergencyPhone   String
  medicalNotes     String?
  waiverAcceptedAt DateTime
  answers          Json
  createdAt        DateTime @default(now())

  event Event @relation(fields: [eventId], references: [id], onDelete: Cascade)
}

model AdminUser {
  id    String @id @default(cuid())
  email String @unique
  role  String @default("admin")
}

model Account {
  id                 String  @id @default(cuid())
  userId             String
  type               String
  provider           String
  providerAccountId  String
  refresh_token      String?
  access_token       String?
  expires_at         Int?
  token_type         String?
  scope              String?
  id_token           String?
  session_state      String?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String?   @unique
  emailVerified DateTime?
  image         String?
  accounts      Account[]
  sessions      Session[]
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}
